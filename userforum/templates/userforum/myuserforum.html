{% extends "userforum/forumbaseprivate.html" %}
{% load static %}

	{% block main %}
	<main>
		<section id="hero_in"  class="courses" style="background: url({{header.image}});background-repeat: no-repeat;background-position: center;background-size: cover;">
			<div class="wrapper" style="background-color: rgba(70, 56, 102, 0.26);" >
				<div class="container">
					<div class="bs-wizard clearfix">
						<h1 class="fadeInUp"><span></span>Bài Viết Của Tôi</h1>
					</div>
					<!-- End bs-wizard -->
				</div>
			</div>
		</section>
		<!--/hero_in-->
		<div class="filters_listing sticky_horizontal">
			<div class="container">
				<ul class="clearfix">
					<li>
						<div class="switch-field">
							<input type="radio" id="all" name="listing_filter" value="all" checked>
							<label for="all">Mới Nhất</label>
							<input type="radio" id="popular" name="listing_filter" value="popular">
							<label for="popular">Phổ Biến</label>
						</div>
					</li>

					<li>
						<select id="enviromentcate" name="orderby" >
							<option value="">Môi Trường</option>
							{% for enviromentcate in enviromentcates %}
								<option value="{{enviromentcate.enviromentcateid}}">{{enviromentcate.enviromentcatename}}</option>
							{% endfor %}
						</select>
					</li>
				</ul>
			</div>
			<!-- /container -->

		</div>
		
		<div class="bg_color_1">
			<div class="container margin_60_35">

				
				
				<div class="row">
					<div class= "col-lg-12">
						<div style="width: 100%; position: static" align=right>
							<a href="{% url 'userforum:myuserforumpost' account.accountid %}"><button class="btn_1"><i class="icon-pencil"></i> Tạo Bài Viết </button></a>
						</div>
						<br>
						<div class="box_cart">
						
						<div  id="custom-search-input">
							<div class="input-group">
								<input id="forname" type="text" class=" search-query" style = "border: 2px solid #fcc107" placeholder="Tìm kiếm bài viết...">
								<input type="submit" class="btn_search" value="Tìm Kiếm">
							</div>
						</div>
						
						<hr>
						<table  class="table table-striped cart-list">
							<thead>
								<tr>
									<th style="width: 5%; text-align: center">
										<strong style="font-family : Arial;" > Avatar</strong>
									</th >
									<th style="width: 25%; text-align: center">
										<strong style="font-family : Arial">Chủ Đề </strong> 
									</th>
									<th style="width: 25%; text-align: center">
										<strong style="font-family : Arial">Tác Giả</strong>
									</th>
									<th style="width: 15%; text-align: center">
										<strong style="font-family : Arial">Ngày Đăng</strong>
									</th>
									<th style="width: 10%; text-align: center">
										<strong style="font-family : Arial">Lượt Xem</strong> 
									</th>
									<th style="width: 10%; text-align: center">
										<strong style="font-family : Arial"></strong> 
									</th>
									<th style="width: 10%; text-align: center">
										<strong style="font-family : Arial"></strong> 
									</th>
								</tr>
							</thead>
							<tbody id = "forumtable">
							{% for userforlist in userdetailforumlist %}
								<tr>
									<td class="options" style="width:5%; text-align:center;">
										<div class="thumb_cart" style = "border-radius: 50%">
											{% if userforlist.forum.avatar != null %}
												<img src="{{userforlist.forum.avatar}}" alt="Image" style="width:40px;height:40px;border-radius:50%;display:inline">
											{% else %}
												<img src="http://via.placeholder.com/150x150/ccc/fff/avatar1.jpg" alt="Image" style="width:40px;height:40px;border-radius:50%;display:inline">
											{% endif %}
										</div>
									</td>
									<td style="text-align: justify">
										<span class="options" ><a href="{% url 'userforum:userforumblog' userforlist.forum.forumtopicid %}">{{userforlist.forum.forumtopicname}}</a></span>
									</td>
									<td class="options" style="width:5%; text-align:center;">
										<strong>{{userforlist.userdetail.lastname}} {{userforlist.userdetail.firstname}}</strong>
									</td>
									<td class="options" style="width:5%; text-align:center;">
										<strong>{{userforlist.forum.createdate.day}}-{{userforlist.forum.createdate.month}}-{{userforlist.forum.createdate.year}}</strong>
									</td>
									<td class="options" style="width:5%; text-align:center;">
										<strong>{{userforlist.forum.viewcount}}</strong>
									</td>
									<td class="options" style="width:5%; text-align:center;">
										{% comment %} <strong>edit</strong> {% endcomment %}
										<a href="{% url 'userforum:myuserforumedit' account.accountid userforlist.forum.forumtopicid %}"><i class="icon-edit"></i>Sửa</a>
									</td>
									<td class="options" style="width:5%; text-align:center;">
										<a><i class="icon-edit"></i>Xóa</a>
									</td>
								</tr>
							{% endfor %}
								
							</tbody>
						</table>
						{% comment %} <div style="align: center" class="pagination">
						<span class="step-links">
							{% if userdetailforumlist.has_previous %}
								<a href="?page=1">&laquo; Trang đầu</a>
								<a href="?page={{ userdetailforumlist.previous_page_number }}">Trang trước</a>
							{% endif %}

							<span class="current">
								Page {{ userdetailforumlist.number }} of {{ userdetailforumlist.paginator.num_pages }}.
							</span>

							{% if userdetailforumlist.has_next %}
								<a href="?page={{ userdetailforumlist.next_page_number }}">Trang kế</a>
								<a href="?page={{ userdetailforumlist.paginator.num_pages }}">Trang cuối &raquo;</a>
							{% endif %}
						</span>
					</div> {% endcomment %}
						<!-- /cart-options -->
					</div>
					<div style="width: 100%; " align=center>
					<button id="loadmore" class="btn_1 rounded add_top_30" style="border-radius:5%"> Xem thêm </button>
					</div>
					</div>
					<!-- /col -->
					

				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /bg_color_1 -->

		<input id="check" value="1" style="display: none"></input>
	

<input id="page" value=0 style="display: none">
<input id="delfor" value=0 style="display: none">
<input id="forumtopicid" style="display: none">
<script>
	$( document ).ready(function() {
		var enviromentcate = $(this).val();
		var check =  $('#check').val();
		$("#forumtopicid").val('');
		$("#delfor").val(0);
    	loadnew();
	});

	$("#all").click(function() {
        $('#check').val(1);
		var check =  $('#check').val();
		var enviromentcate = $('#enviromentcate').val();
		$("#page").val(0);
		$("#forumtopicid").val('');
		$("#delfor").val(0);
		loadnew();
	});

	$("#popular").click(function(){
        $('#check').val(2);
		var check =  $('#check').val();
		$("#page").val(0);
		var enviromentcate = $('#enviromentcate').val();
		$("#forumtopicid").val('');
		$("#delfor").val(0);
		loadnew();
	});

	$("#forname").keyup(function()
	{
		var forname = $(this).val();
		var enviromentcate = $('#enviromentcate').val();
		var check =  $('#check').val();
		$("#page").val(0);
		$("#forumtopicid").val('');
		$("#delfor").val(0);
		loadnew();
	});

	$("#enviromentcate").change(function() {
        var enviromentcate = $(this).val();
		var check =  $('#check').val();
		$("#forumtopicid").val('');
		$("#delfor").val(0);
		$("#page").val(0);
		loadnew();
	});

	$("#loadmore").click(function()
	{
		var page =$("#page").val() + 1 ;
		$("#page").val(page);
		$("#forumtopicid").val('');
		$("#delfor").val(0);
		loadnew();
	});
	function ForumDelete(forumtopicid){
		$("#forumtopicid").val(forumtopicid);
		var enviromentcate = $('#enviromentcate').val();
		var check =  $('#check').val();
		$("#page").val(0);
		$("#delfor").val(1);
    	loadnew();
	}
	function loadnew(){
		var forname = $("#forname").val();
		var enviromentcate =$("#enviromentcate").val();
		var forumtopicid =$("#forumtopicid").val();
		var check =  $('#check').val();
		var page = $("#page").val();
		var delfor = $("#delfor").val();

		$.ajax({
			url: '/ajax/forumshowofme/',
			data: {
				'forname': forname,
				'enviromentcate': enviromentcate,
				'page': page,
				'check': check,
				'delfor': delfor,
				'forumtopicid': forumtopicid,
			},
			dataType: 'json',
			success: function(data){
				if (page == 0){
					$("#forumtable").html(data.s);
				}
				else
				{
					var divdom = $("#forumtable").html();
					var adddiv = divdom + data.s;
					$("#forumtable").html(adddiv);
				}
				if (data.btnmore == 1){
					$("#loadmore").css({"display":""});
				}
				else{
					$("#loadmore").css({"display":"none"});
				}
			}
		})
	}
</script>


	{% endblock %}
	<!--/main-->
	
